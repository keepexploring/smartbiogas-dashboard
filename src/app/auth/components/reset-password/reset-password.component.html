<app-view-header title="Reset Password"></app-view-header>
<app-loading *ngIf="loading"></app-loading>

<div *ngIf="!loading">

  <div *ngIf="!isCodeValid" class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
    <form class="mb-1" (ngSubmit)="onSubmitCode()" [formGroup]="codeForm">
      <div class="form-group">
        <label for="code">Enter Code</label>
        <div class="input-group">
          <input type="text" class="form-control" formControlName="code" aria-describedby="codeHelp" placeholder="Enter the received code">
        </div>
        <app-form-errors [formInput]="code"></app-form-errors>
      </div>

      <div class="form-group">
        <button type="submit" class="btn btn-primary" [disabled]="codeForm.invalid">Submit</button>
      </div>
    </form>
  </div>

  <div *ngIf="isCodeValid" class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
    <form class="mb-1" (ngSubmit)="onSubmitPassword()" [formGroup]="resetPasswordForm">
      <div class="form-group">
        <label for="newPassword">New Password</label>
        <div class="input-group">
          <input type="{{passwordShown ? 'password' : 'text'}}" class="form-control" formControlName="password" id="newPassword" aria-describedby="passwordHelp"
            placeholder="Enter a new password">

          <div class="input-group-append">
            <button class="btn" [class.btn-outline-secondary]="!passwordShown" [class.btn-secondary]="passwordShown" type="button" data-toggle="button"
              (click)="showPassword()">
              <i-eye *ngIf="passwordShown"></i-eye>
              <i-eye-off *ngIf="!passwordShown"></i-eye-off>
            </button>
          </div>
        </div>
        <app-form-errors [formInput]="password"></app-form-errors>
      </div>

      <div class="form-group">
        <button type="submit" class="btn btn-primary" [disabled]="resetPasswordForm.invalid">Submit</button>
      </div>
    </form>
  </div>

  <a routerLink="/forgot-password">Code not received?</a>
</div>